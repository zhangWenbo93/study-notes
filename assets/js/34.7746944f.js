(window.webpackJsonp=window.webpackJsonp||[]).push([[34],{482:function(s,t,a){"use strict";a.r(t);var e=a(40),n=Object(e.a)({},(function(){var s=this,t=s.$createElement,a=s._self._c||t;return a("ContentSlotsDistributor",{attrs:{"slot-key":s.$parent.slotKey}},[a("h1",{attrs:{id:"常用命令"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#常用命令"}},[s._v("#")]),s._v(" 常用命令")]),s._v(" "),a("h2",{attrs:{id:"pm2-常用命令"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#pm2-常用命令"}},[s._v("#")]),s._v(" PM2 常用命令")]),s._v(" "),a("div",{staticClass:"custom-block tip"},[a("p",{staticClass:"custom-block-title"},[s._v("TIP")]),s._v(" "),a("p",[s._v("pm2文档地址"),a("a",{attrs:{href:"http://pm2.keymetrics.io/docs/usage/quick-start/",target:"_blank",rel:"noopener noreferrer"}},[s._v("查看"),a("OutboundLink")],1)])]),s._v(" "),a("ul",[a("li",[a("p",[s._v("pm2 start app.js     # 启动app.js应用程序")])]),s._v(" "),a("li",[a("p",[s._v("pm2 start app.js -i 4        # cluster mode 模式启动4个app.js的应用实例，4个应用程序会自动进行负载均衡")])]),s._v(" "),a("li",[a("p",[s._v('pm2 start app.js --name="api" # 启动应用程序并命名为 "api"')])]),s._v(" "),a("li",[a("p",[s._v("pm2 start app.js --watch      # 当文件变化时自动重启应用")])]),s._v(" "),a("li",[a("p",[s._v("pm2 start script.sh          # 启动 bash 脚本")])]),s._v(" "),a("li",[a("p",[s._v("pm2 list                      # 列表 PM2 启动的所有的应用程序")])]),s._v(" "),a("li",[a("p",[s._v("pm2 monit                    # 显示每个应用程序的CPU和内存占用情况")])]),s._v(" "),a("li",[a("p",[s._v("pm2 show [app-name]          # 显示应用程序的所有信息")])]),s._v(" "),a("li",[a("p",[s._v("pm2 logs                      # 显示所有应用程序的日志")])]),s._v(" "),a("li",[a("p",[s._v("pm2 logs [app-name]          # 显示指定应用程序的日志")])]),s._v(" "),a("li",[a("p",[s._v("pm2 flush                       # 清空所有日志文件")])]),s._v(" "),a("li",[a("p",[s._v("pm2 stop all                  # 停止所有的应用程序")])]),s._v(" "),a("li",[a("p",[s._v("pm2 stop 0                    # 停止 id为 0的指定应用程序")])]),s._v(" "),a("li",[a("p",[s._v("pm2 restart all              # 重启所有应用")])]),s._v(" "),a("li",[a("p",[s._v("pm2 reload all                # 重启 cluster mode下的所有应用")])]),s._v(" "),a("li",[a("p",[s._v("pm2 gracefulReload all        # Graceful reload all apps in cluster mode")])]),s._v(" "),a("li",[a("p",[s._v("pm2 delete all                # 关闭并删除所有应用")])]),s._v(" "),a("li",[a("p",[s._v("pm2 delete 0                  # 删除指定应用 id 0")])]),s._v(" "),a("li",[a("p",[s._v("pm2 scale api 10              # 把名字叫api的应用扩展到10个实例")])]),s._v(" "),a("li",[a("p",[s._v("pm2 reset [app-name]          # 重置重启数量")])]),s._v(" "),a("li",[a("p",[s._v("pm2 startup                  # 创建开机自启动命令")])]),s._v(" "),a("li",[a("p",[s._v("pm2 save                      # 保存当前应用列表")])]),s._v(" "),a("li",[a("p",[s._v("pm2 resurrect                # 重新加载保存的应用列表")])]),s._v(" "),a("li",[a("p",[s._v("pm2 update                    # 保存进程、终止PM2和恢复进程")])]),s._v(" "),a("li",[a("p",[s._v("pm2 generate                  # 生成示例json配置文件")])])]),s._v(" "),a("h2",{attrs:{id:"防止服务器断开连接"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#防止服务器断开连接"}},[s._v("#")]),s._v(" 防止服务器断开连接")]),s._v(" "),a("div",{staticClass:"language-sh extra-class"},[a("pre",{pre:!0,attrs:{class:"language-sh"}},[a("code",[a("span",{pre:!0,attrs:{class:"token function"}},[s._v("vim")]),s._v(" /etc/ssh/sshd_config\n\nClientAliveInterval "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("30")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 开启 ClientAliveInterval 修改为 30 表示每30自动连接")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("service")]),s._v(" sshd restart   "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 重启sshd")]),s._v("\n")])])]),a("h2",{attrs:{id:"centos-7下启动、关闭、重启、查看mysql服务"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#centos-7下启动、关闭、重启、查看mysql服务"}},[s._v("#")]),s._v(" CentOS 7下启动、关闭、重启、查看MySQL服务")]),s._v(" "),a("ul",[a("li",[s._v("启动命令")])]),s._v(" "),a("div",{staticClass:"language-sh extra-class"},[a("pre",{pre:!0,attrs:{class:"language-sh"}},[a("code",[a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@xxx ~"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# service mysqld start")]),s._v("\nRedirecting to /bin/systemctl start  mysqld.service\n")])])]),a("ul",[a("li",[s._v("关闭命令")])]),s._v(" "),a("div",{staticClass:"language-sh extra-class"},[a("pre",{pre:!0,attrs:{class:"language-sh"}},[a("code",[a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@xxx ~"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# service mysqld stop")]),s._v("\nRedirecting to /bin/systemctl stop  mysqld.service\n")])])]),a("ul",[a("li",[s._v("重启命令")])]),s._v(" "),a("div",{staticClass:"language-sh extra-class"},[a("pre",{pre:!0,attrs:{class:"language-sh"}},[a("code",[a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@xxx ~"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# service mysqld restart")]),s._v("\nRedirecting to /bin/systemctl restart  mysqld.service\n")])])]),a("ul",[a("li",[s._v("查看服务状态")])]),s._v(" "),a("div",{staticClass:"language-sh extra-class"},[a("pre",{pre:!0,attrs:{class:"language-sh"}},[a("code",[a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@xxx ~"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# service mysqld status")]),s._v("\nRedirecting to /bin/systemctl status mysqld.service\n● mysqld.service - MySQL Server\n   Loaded: loaded "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("/usr/lib/systemd/system/mysqld.service"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v(" enabled"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v(" vendor preset: disabled"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n   Active: active "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("running"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" since Fri "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("2021")]),s._v("-05-14 "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("10")]),s._v(":06:17 CST"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v(" 6h ago\n     Docs: man:mysqld"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("8")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n           http://dev.mysql.com/doc/refman/en/using-systemd.html\n  Process: "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("31890")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("ExecStartPre")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("/usr/bin/mysqld_pre_systemd "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("code"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("exited, "),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("status")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("/SUCCESS"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n Main PID: "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("31913")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("mysqld"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n   Status: "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"Server is operational"')]),s._v("\n   CGroup: /system.slice/mysqld.service\n           └─31913 /usr/sbin/mysqld\n\nMay "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("14")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("10")]),s._v(":06:15 wbhy systemd"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(": Starting MySQL Server"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("..")]),s._v(".\nMay "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("14")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("10")]),s._v(":06:17 wbhy systemd"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(": Started MySQL Server.\n")])])]),a("ul",[a("li",[s._v("查看MySql系统配置")])]),s._v(" "),a("div",{staticClass:"language-sh extra-class"},[a("pre",{pre:!0,attrs:{class:"language-sh"}},[a("code",[a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@xxx ~"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# cat /etc/my.cnf")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# For advice on how to change settings please see")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# http://dev.mysql.com/doc/refman/8.0/en/server-configuration-defaults.html")]),s._v("\n\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("mysqld"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("character_set_server")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("utf8\ninit-connect"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'SET NAMES utf8'")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 设置模式")]),s._v("\nsql_mode "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("STRICT_TRANS_TABLES,NO_ZERO_IN_DATE,NO_ZERO_DATE,ERROR_FOR_DIVISION_BY_ZERO,NO_ENGINE_SUBSTITUTION\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# validate_password_policy=0")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# validate_password.mixed_case_count=0")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# validate_password.number_count=3")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# validate_password.special_char_count=0")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# validate_password.length=6")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# Remove leading # and set to the amount of RAM for the most important data")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# cache in MySQL. Start at 70% of total RAM for dedicated server, else 10%.")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# innodb_buffer_pool_size = 128M")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v('# Remove the leading "# " to disable binary logging')]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# Binary logging captures changes between backups and is enabled by")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# default. It's default setting is log_bin=binlog")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# disable_log_bin")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# Remove leading # to set options mainly useful for reporting servers.")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# The server defaults are faster for transactions and fast SELECTs.")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# Adjust sizes as needed, experiment to find the optimal values.")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# join_buffer_size = 128M")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# sort_buffer_size = 2M")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# read_rnd_buffer_size = 2M")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# Remove leading # to revert to previous value for default_authentication_plugin,")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# this will increase compatibility with older clients. For background, see:")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# https://dev.mysql.com/doc/refman/8.0/en/server-system-variables.html#sysvar_default_authentication_plugin")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# default-authentication-plugin=mysql_native_password")]),s._v("\n\n"),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("datadir")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("/var/lib/mysql\n"),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("socket")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("/var/lib/mysql/mysql.sock\n\nlog-error"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("/var/log/mysqld.log\npid-file"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("/var/run/mysqld/mysqld.pid\n")])])]),a("h2",{attrs:{id:"nginx常用命令"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#nginx常用命令"}},[s._v("#")]),s._v(" Nginx常用命令")]),s._v(" "),a("ul",[a("li",[s._v("设置 Nginx 开机启动")])]),s._v(" "),a("div",{staticClass:"language-sh extra-class"},[a("pre",{pre:!0,attrs:{class:"language-sh"}},[a("code",[a("span",{pre:!0,attrs:{class:"token function"}},[s._v("sudo")]),s._v(" systemctl "),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("enable")]),s._v(" nginx\n")])])]),a("ul",[a("li",[s._v("关闭开机启动 Nginx")])]),s._v(" "),a("div",{staticClass:"language-sh extra-class"},[a("pre",{pre:!0,attrs:{class:"language-sh"}},[a("code",[a("span",{pre:!0,attrs:{class:"token function"}},[s._v("sudo")]),s._v(" systemctl disable nginx\n")])])]),a("ul",[a("li",[s._v("检查 Nginx 的运行状态")])]),s._v(" "),a("div",{staticClass:"language-sh extra-class"},[a("pre",{pre:!0,attrs:{class:"language-sh"}},[a("code",[a("span",{pre:!0,attrs:{class:"token function"}},[s._v("sudo")]),s._v(" systemctl status nginx\n")])])]),a("ul",[a("li",[s._v("启动 Nginx")])]),s._v(" "),a("div",{staticClass:"language-sh extra-class"},[a("pre",{pre:!0,attrs:{class:"language-sh"}},[a("code",[a("span",{pre:!0,attrs:{class:"token function"}},[s._v("sudo")]),s._v(" systemctl start nginx\n")])])]),a("ul",[a("li",[s._v("停止 Nginx")])]),s._v(" "),a("div",{staticClass:"language-sh extra-class"},[a("pre",{pre:!0,attrs:{class:"language-sh"}},[a("code",[a("span",{pre:!0,attrs:{class:"token function"}},[s._v("sudo")]),s._v(" systemctl stop nginx\n")])])]),a("ul",[a("li",[s._v("重启 Nginx")])]),s._v(" "),a("div",{staticClass:"language-sh extra-class"},[a("pre",{pre:!0,attrs:{class:"language-sh"}},[a("code",[a("span",{pre:!0,attrs:{class:"token function"}},[s._v("sudo")]),s._v(" systemctl restart nginx\n")])])]),a("ul",[a("li",[s._v("修改 Nginx 配置后，重新加载")])]),s._v(" "),a("div",{staticClass:"language-sh extra-class"},[a("pre",{pre:!0,attrs:{class:"language-sh"}},[a("code",[a("span",{pre:!0,attrs:{class:"token function"}},[s._v("sudo")]),s._v(" systemctl reload nginx\n")])])]),a("h2",{attrs:{id:"nginx-的配置文件和最佳实践"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#nginx-的配置文件和最佳实践"}},[s._v("#")]),s._v(" Nginx 的配置文件和最佳实践")]),s._v(" "),a("ul",[a("li",[s._v("通过以上方式安装的 "),a("code",[s._v("Nginx")]),s._v("，所有相关的配置文件都在 "),a("code",[s._v("/etc/nginx/")]),s._v(" 目录中。")]),s._v(" "),a("li",[a("code",[s._v("Nginx")]),s._v(" 的主配置文件是 "),a("code",[s._v("/etc/nginx/nginx.conf")]),s._v("。\n为了使 "),a("code",[s._v("Nginx")]),s._v(" 配置更易于维护，建议为每个服务（域名）创建一个单独的配置文件。")]),s._v(" "),a("li",[s._v("每一个独立的 "),a("code",[s._v("Nginx")]),s._v(" 服务配置文件都必须以 "),a("code",[s._v(".conf")]),s._v(" 结尾，并存储在 "),a("code",[s._v("/etc/nginx/conf.d")]),s._v(" 目录中。您可以根据需求，创建任意多个独立的配置文件。")]),s._v(" "),a("li",[s._v("独立的配置文件，建议遵循以下命名约定，比如你的域名是 "),a("code",[s._v("xxxx.com")]),s._v("，那么你的配置文件的应该是这样的 "),a("code",[s._v("/etc/nginx/conf.d/xxxx.com.conf")]),s._v("，如果你在一个服务器中部署多个服务，当然你也可以在文件名中加上 Nginx 转发的端口号，比如 "),a("code",[s._v("xxxxx.com.3000.conf")]),s._v("，这样做看起来会更加友好。")]),s._v(" "),a("li",[s._v("如果你的配置中有很多重复的代码，那么建议你创建一个 "),a("code",[s._v("/etc/nginx/snippets")]),s._v(" 文件夹，在这里面存放所有会被复用的代码块，然后在各个需要用到的 "),a("code",[s._v("Nginx")]),s._v(" 的配置文件中引用进去，这样可以更方便管理和修改。")]),s._v(" "),a("li",[a("code",[s._v("Nginx")]),s._v(" 日志文件 "),a("code",[s._v("（access.log 和 error.log ）")]),s._v(" 位于 "),a("code",[s._v("/var/log/nginx/")]),s._v(" 目录中。建议为每个独立的服务配置不同的访问权限和错误日志文件，这样查找错误时，会更加方便快捷。")]),s._v(" "),a("li",[s._v("你可以将要部署的代码文件，存储在任何你想的位置，但是一般推荐存放在下列位置中的其中一个：\n"),a("ul",[a("li",[s._v("/home/<user_name>/<site_name>")]),s._v(" "),a("li",[s._v("/var/www/<site_name>")]),s._v(" "),a("li",[s._v("/var/www/html/<site_name>")]),s._v(" "),a("li",[s._v("/opt/<site_name>")]),s._v(" "),a("li",[s._v("/usr/share/nginx/html")])])])])])}),[],!1,null,null,null);t.default=n.exports}}]);