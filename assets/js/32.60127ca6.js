(window.webpackJsonp=window.webpackJsonp||[]).push([[32],{480:function(s,t,a){"use strict";a.r(t);var n=a(40),e=Object(n.a)({},(function(){var s=this,t=s.$createElement,a=s._self._c||t;return a("ContentSlotsDistributor",{attrs:{"slot-key":s.$parent.slotKey}},[a("h1",{attrs:{id:"功能分析"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#功能分析"}},[s._v("#")]),s._v(" 功能分析")]),s._v(" "),a("h2",{attrs:{id:"epub-电子书"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#epub-电子书"}},[s._v("#")]),s._v(" epub 电子书")]),s._v(" "),a("p",[s._v("epub 是一种电子书格式，它的本质是一个 zip 压缩包")]),s._v(" "),a("p",[s._v("通过 "),a("code",[s._v("container.xml")]),s._v(" 中的 "),a("code",[s._v('<rootfile full-path="content.opf">')]),s._v(" 找到对应的 "),a("code",[s._v("content.opf")]),s._v(" ，在通过 "),a("code",[s._v("content.opf")]),s._v(" 中的 "),a("code",[s._v("spine")]),s._v(" 找到整个电子书的阅读顺序，所有的资源映射到 "),a("code",[s._v("content.opf")]),s._v(" 中的 "),a("code",[s._v("manifest")]),s._v(" 找到对应的资源, 同时 "),a("code",[s._v("toc.ncx")]),s._v(" 中找到整个电子书的目录的渲染。")]),s._v(" "),a("h2",{attrs:{id:"nginx-搭建"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#nginx-搭建"}},[s._v("#")]),s._v(" Nginx 搭建")]),s._v(" "),a("h3",{attrs:{id:"安装-nginx"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#安装-nginx"}},[s._v("#")]),s._v(" 安装 nginx")]),s._v(" "),a("p",[s._v("mac 通过 brew 安装 参考:"),a("a",{attrs:{href:"https://www.jianshu.com/p/c3294887c6b6",target:"_blank",rel:"noopener noreferrer"}},[s._v("查看"),a("OutboundLink")],1)]),s._v(" "),a("h3",{attrs:{id:"修改配置文件"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#修改配置文件"}},[s._v("#")]),s._v(" 修改配置文件")]),s._v(" "),a("p",[s._v("打开配置文件 nginx.conf")]),s._v(" "),a("p",[s._v("macOS 位于："),a("code",[s._v("/usr/local/etc/nginx/nginx.conf")])]),s._v(" "),a("ul",[a("li",[s._v("添加当前登录用户为owner")])]),s._v(" "),a("div",{staticClass:"language-js extra-class"},[a("pre",{pre:!0,attrs:{class:"language-js"}},[a("code",[s._v("user 本机名 owner"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n")])])]),a("ul",[a("li",[s._v("在结尾大括号之前添加")])]),s._v(" "),a("div",{staticClass:"language-js extra-class"},[a("pre",{pre:!0,attrs:{class:"language-js"}},[a("code",[s._v("include "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("Users"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("本机名"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("upload"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("upload"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("conf"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n")])])]),a("ul",[a("li",[s._v("添加 /Users/本机名/upload/upload.conf 文件，配置如下")])]),s._v(" "),a("div",{staticClass:"language-js extra-class"},[a("pre",{pre:!0,attrs:{class:"language-js"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// 在本机的初始位置")]),s._v("\nmkdir upload\n\ncd upload\n\ntouch upload"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("conf\n\nvim upload"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("conf\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// 加入如下配置")]),s._v("\n\nserver\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n  charset utf"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("8")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n  listen "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("8089")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n  server_name http_host"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n  root "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("Users"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("本机名"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("upload"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n  autoindex on"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n  add_header Cache"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("Control "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"no-cache, must-revalidate"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n  location "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n    add_header Access"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("Control"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("Allow"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("Origin "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("*")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n  "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n")])])]),a("ul",[a("li",[s._v("charset 字符编码类型")]),s._v(" "),a("li",[s._v("listen 监听的端口号，Mac有限制，因此不能使用80，如果部署到 Linux 上，则没有限制，可以使用80")]),s._v(" "),a("li",[s._v("server_name 命名")]),s._v(" "),a("li",[s._v("root 资源文件的路径")]),s._v(" "),a("li",[s._v("autoindex 是否打开一个索引，通常线上为 "),a("code",[s._v("off")]),s._v("，防止暴露所有的资源文件")]),s._v(" "),a("li",[s._v("add_header\n"),a("ul",[a("li",[s._v("Cache-Control 每次发起请求，会添加 "),a("code",[s._v("Cache-Control")])]),s._v(" "),a("li",[s._v("no-cache 如果不添加，nginx 会默认添加缓存")])])]),s._v(" "),a("li",[s._v("location 指的路由，不同的路由有不同的配置\n"),a("ul",[a("li",[s._v("/ 代表所有的路由")]),s._v(" "),a("li",[s._v("add_header 给所有的 Response 添加 "),a("code",[s._v("Access-Control-Allow-Origin")]),s._v(" 防止跨域")]),s._v(" "),a("li",[a("code",[s._v("*")]),s._v(" 实际上线将这个改成允许访问的域名")])])])]),s._v(" "),a("p",[s._v("如果需要加入 https 服务，可以再添加一个 server：")]),s._v(" "),a("div",{staticClass:"language-js extra-class"},[a("pre",{pre:!0,attrs:{class:"language-js"}},[a("code",[s._v("server\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n  listen "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("443")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("default")]),s._v(" ssl"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n  server_name https_host"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n  root "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("Users"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("本机名"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("upload"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n  autoindex on"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n  add_header Cache"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("Control "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"no-cache, must-revalidate"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n  location "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n    add_header Access"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("Control"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("Allow"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("Origin "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("*")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n  "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n  ssl_certificate "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("Users"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("本机名"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("Desktop"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("https"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("域名"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("pem"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n  ssl_certificate_key "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("Users"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("本机名"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("Desktop"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("https"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("域名"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("key"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n  ssl_session_timeout  "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("5")]),s._v("m"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n  ssl_protocols  SSLv3 TLSv1"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n  ssl_ciphers  "),a("span",{pre:!0,attrs:{class:"token constant"}},[s._v("ALL")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("!")]),a("span",{pre:!0,attrs:{class:"token constant"}},[s._v("ADH")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("!")]),a("span",{pre:!0,attrs:{class:"token constant"}},[s._v("EXPORT56")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),a("span",{pre:!0,attrs:{class:"token constant"}},[s._v("RC4")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("+")]),a("span",{pre:!0,attrs:{class:"token constant"}},[s._v("RSA")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("+")]),a("span",{pre:!0,attrs:{class:"token constant"}},[s._v("HIGH")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("+")]),a("span",{pre:!0,attrs:{class:"token constant"}},[s._v("MEDIUM")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("+")]),a("span",{pre:!0,attrs:{class:"token constant"}},[s._v("LOW")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("+")]),s._v("SSLv2"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("+")]),a("span",{pre:!0,attrs:{class:"token constant"}},[s._v("EXP")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n  ssl_prefer_server_ciphers  on"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n")])])]),a("ul",[a("li",[s._v("https证书：/Users/本机名/Desktop/https/域名.pem")]),s._v(" "),a("li",[s._v("https:私钥：/Users/本机名/Desktop/https/域名.key")])]),s._v(" "),a("h3",{attrs:{id:"nginx-启动相关"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#nginx-启动相关"}},[s._v("#")]),s._v(" Nginx 启动相关")]),s._v(" "),a("p",[s._v("启动 nginx 服务")]),s._v(" "),a("div",{staticClass:"language-js extra-class"},[a("pre",{pre:!0,attrs:{class:"language-js"}},[a("code",[s._v("sudo nginx\n")])])]),a("p",[s._v("停止 nginx 服务")]),s._v(" "),a("div",{staticClass:"language-js extra-class"},[a("pre",{pre:!0,attrs:{class:"language-js"}},[a("code",[s._v("sudo nginx "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("s stop\n")])])]),a("p",[s._v("重启 nginx 服务")]),s._v(" "),a("div",{staticClass:"language-js extra-class"},[a("pre",{pre:!0,attrs:{class:"language-js"}},[a("code",[s._v("sudo nginx "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("s reload\n")])])]),a("p",[s._v("检查配置文件是否存在语法错误")]),s._v(" "),a("div",{staticClass:"language-js extra-class"},[a("pre",{pre:!0,attrs:{class:"language-js"}},[a("code",[s._v("sudo nginx "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("t\n")])])])])}),[],!1,null,null,null);t.default=e.exports}}]);