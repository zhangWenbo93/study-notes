<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>安全的 HTTPS | Notes</title>
    <meta name="generator" content="VuePress 1.7.1">
    
    <meta name="description" content="自我学习">
    
    <link rel="preload" href="/study-notes/assets/css/0.styles.f313a13a.css" as="style"><link rel="preload" href="/study-notes/assets/js/app.039e21f8.js" as="script"><link rel="preload" href="/study-notes/assets/js/2.c66ffe4c.js" as="script"><link rel="preload" href="/study-notes/assets/js/12.6d5c0016.js" as="script"><link rel="prefetch" href="/study-notes/assets/js/10.1f4a0ba6.js"><link rel="prefetch" href="/study-notes/assets/js/11.3f135838.js"><link rel="prefetch" href="/study-notes/assets/js/13.385e80e5.js"><link rel="prefetch" href="/study-notes/assets/js/14.0abbf9c6.js"><link rel="prefetch" href="/study-notes/assets/js/15.f1a675c1.js"><link rel="prefetch" href="/study-notes/assets/js/16.cff045ba.js"><link rel="prefetch" href="/study-notes/assets/js/17.1b9fa201.js"><link rel="prefetch" href="/study-notes/assets/js/18.15b4e5fe.js"><link rel="prefetch" href="/study-notes/assets/js/19.96819d01.js"><link rel="prefetch" href="/study-notes/assets/js/20.3d35b0e0.js"><link rel="prefetch" href="/study-notes/assets/js/21.b1b57cb8.js"><link rel="prefetch" href="/study-notes/assets/js/22.33771dfd.js"><link rel="prefetch" href="/study-notes/assets/js/23.a732b160.js"><link rel="prefetch" href="/study-notes/assets/js/24.24b15227.js"><link rel="prefetch" href="/study-notes/assets/js/25.69c4ed30.js"><link rel="prefetch" href="/study-notes/assets/js/26.78ff0822.js"><link rel="prefetch" href="/study-notes/assets/js/27.fe95212f.js"><link rel="prefetch" href="/study-notes/assets/js/28.7ad1509a.js"><link rel="prefetch" href="/study-notes/assets/js/29.61218e4f.js"><link rel="prefetch" href="/study-notes/assets/js/3.63146466.js"><link rel="prefetch" href="/study-notes/assets/js/30.f23314bb.js"><link rel="prefetch" href="/study-notes/assets/js/31.cdae011c.js"><link rel="prefetch" href="/study-notes/assets/js/32.60127ca6.js"><link rel="prefetch" href="/study-notes/assets/js/33.ff9cf28d.js"><link rel="prefetch" href="/study-notes/assets/js/34.7746944f.js"><link rel="prefetch" href="/study-notes/assets/js/35.0216b661.js"><link rel="prefetch" href="/study-notes/assets/js/36.fcf7055f.js"><link rel="prefetch" href="/study-notes/assets/js/37.6e2d7c68.js"><link rel="prefetch" href="/study-notes/assets/js/38.a9661128.js"><link rel="prefetch" href="/study-notes/assets/js/39.f25b8af3.js"><link rel="prefetch" href="/study-notes/assets/js/4.1b408ca5.js"><link rel="prefetch" href="/study-notes/assets/js/40.b2812eac.js"><link rel="prefetch" href="/study-notes/assets/js/41.e63c192c.js"><link rel="prefetch" href="/study-notes/assets/js/42.91310054.js"><link rel="prefetch" href="/study-notes/assets/js/43.195adb7b.js"><link rel="prefetch" href="/study-notes/assets/js/44.b82e0971.js"><link rel="prefetch" href="/study-notes/assets/js/45.54e35d71.js"><link rel="prefetch" href="/study-notes/assets/js/46.4b06e4d8.js"><link rel="prefetch" href="/study-notes/assets/js/47.c58d11ab.js"><link rel="prefetch" href="/study-notes/assets/js/48.69319e05.js"><link rel="prefetch" href="/study-notes/assets/js/49.81df32c4.js"><link rel="prefetch" href="/study-notes/assets/js/5.45c26daa.js"><link rel="prefetch" href="/study-notes/assets/js/50.b86cd1f2.js"><link rel="prefetch" href="/study-notes/assets/js/51.48962766.js"><link rel="prefetch" href="/study-notes/assets/js/52.d5814608.js"><link rel="prefetch" href="/study-notes/assets/js/53.12683cf2.js"><link rel="prefetch" href="/study-notes/assets/js/54.7f8f2a18.js"><link rel="prefetch" href="/study-notes/assets/js/55.397b6083.js"><link rel="prefetch" href="/study-notes/assets/js/56.ab7945ea.js"><link rel="prefetch" href="/study-notes/assets/js/57.d03d45cb.js"><link rel="prefetch" href="/study-notes/assets/js/58.bae8dfce.js"><link rel="prefetch" href="/study-notes/assets/js/59.c7d972b0.js"><link rel="prefetch" href="/study-notes/assets/js/6.ceefd9a6.js"><link rel="prefetch" href="/study-notes/assets/js/60.50c38210.js"><link rel="prefetch" href="/study-notes/assets/js/61.2d11d07c.js"><link rel="prefetch" href="/study-notes/assets/js/62.6b2af576.js"><link rel="prefetch" href="/study-notes/assets/js/63.826c65fe.js"><link rel="prefetch" href="/study-notes/assets/js/64.9960e579.js"><link rel="prefetch" href="/study-notes/assets/js/65.ff4ea3f1.js"><link rel="prefetch" href="/study-notes/assets/js/66.f6631330.js"><link rel="prefetch" href="/study-notes/assets/js/67.d010895e.js"><link rel="prefetch" href="/study-notes/assets/js/68.55195346.js"><link rel="prefetch" href="/study-notes/assets/js/69.05dc4f2e.js"><link rel="prefetch" href="/study-notes/assets/js/7.22afd591.js"><link rel="prefetch" href="/study-notes/assets/js/70.9b1fb209.js"><link rel="prefetch" href="/study-notes/assets/js/71.eff503c4.js"><link rel="prefetch" href="/study-notes/assets/js/72.1c282bd5.js"><link rel="prefetch" href="/study-notes/assets/js/73.6258956d.js"><link rel="prefetch" href="/study-notes/assets/js/74.8debcd50.js"><link rel="prefetch" href="/study-notes/assets/js/75.4cef4522.js"><link rel="prefetch" href="/study-notes/assets/js/76.b4268a30.js"><link rel="prefetch" href="/study-notes/assets/js/77.0ec777b3.js"><link rel="prefetch" href="/study-notes/assets/js/8.c8a1b87b.js"><link rel="prefetch" href="/study-notes/assets/js/9.f05e9459.js">
    <link rel="stylesheet" href="/study-notes/assets/css/0.styles.f313a13a.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/study-notes/" class="home-link router-link-active"><!----> <span class="site-name">Notes</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="笔记" class="dropdown-title"><span class="title">笔记</span> <span class="arrow down"></span></button> <button type="button" aria-label="笔记" class="mobile-dropdown-title"><span class="title">笔记</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/study-notes/koa2/restful.html" class="nav-link">
  koa2
</a></li><li class="dropdown-item"><!----> <a href="/study-notes/design-patterns/面向对象_01.html" class="nav-link">
  设计模式
</a></li><li class="dropdown-item"><!----> <a href="/study-notes/interview-advanced/mind-mapping.html" class="nav-link">
  能力进阶
</a></li><li class="dropdown-item"><!----> <a href="/study-notes/cms-vue/advance.html" class="nav-link">
  vue koa 实现后台管理
</a></li><li class="dropdown-item"><!----> <a href="/study-notes/HTTP/了解HTTP协议.html" class="nav-link">
  HTTP协议
</a></li><li class="dropdown-item"><!----> <a href="/study-notes/node/Node.js在前后端的区别.html" class="nav-link">
  node应用开发
</a></li></ul></div></div> <!----></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="笔记" class="dropdown-title"><span class="title">笔记</span> <span class="arrow down"></span></button> <button type="button" aria-label="笔记" class="mobile-dropdown-title"><span class="title">笔记</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/study-notes/koa2/restful.html" class="nav-link">
  koa2
</a></li><li class="dropdown-item"><!----> <a href="/study-notes/design-patterns/面向对象_01.html" class="nav-link">
  设计模式
</a></li><li class="dropdown-item"><!----> <a href="/study-notes/interview-advanced/mind-mapping.html" class="nav-link">
  能力进阶
</a></li><li class="dropdown-item"><!----> <a href="/study-notes/cms-vue/advance.html" class="nav-link">
  vue koa 实现后台管理
</a></li><li class="dropdown-item"><!----> <a href="/study-notes/HTTP/了解HTTP协议.html" class="nav-link">
  HTTP协议
</a></li><li class="dropdown-item"><!----> <a href="/study-notes/node/Node.js在前后端的区别.html" class="nav-link">
  node应用开发
</a></li></ul></div></div> <!----></nav>  <ul class="sidebar-links"><li><section class="sidebar-group depth-0"><p class="sidebar-heading open"><span>HTTP协议</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/study-notes/HTTP/了解HTTP协议.html" class="sidebar-link">了解HTTP协议</a></li><li><a href="/study-notes/HTTP/HTTP协议结构和通讯原理.html" class="sidebar-link">HTTP协议结构和通讯原理</a></li><li><a href="/study-notes/HTTP/HTTP的特性和使用.html" class="sidebar-link">HTTP的特性和使用</a></li><li><a href="/study-notes/HTTP/安全的HTTPS.html" class="active sidebar-link">安全的HTTPS</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/study-notes/HTTP/安全的HTTPS.html#https协议概述" class="sidebar-link">HTTPS协议概述</a></li><li class="sidebar-sub-header"><a href="/study-notes/HTTP/安全的HTTPS.html#https-功能介绍" class="sidebar-link">HTTPS 功能介绍</a></li><li class="sidebar-sub-header"><a href="/study-notes/HTTP/安全的HTTPS.html#使用成本" class="sidebar-link">使用成本</a></li><li class="sidebar-sub-header"><a href="/study-notes/HTTP/安全的HTTPS.html#对性能的影响" class="sidebar-link">对性能的影响</a></li></ul></li><li><a href="/study-notes/HTTP/基于HTTP追加协议.html" class="sidebar-link">基于HTTP追加协议</a></li><li><a href="/study-notes/HTTP/Web安全威胁浅析.html" class="sidebar-link">Web安全威胁浅析</a></li></ul></section></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h1 id="安全的-https"><a href="#安全的-https" class="header-anchor">#</a> 安全的 HTTPS</h1> <blockquote><p>为什么要使用 HTTPS ？</p></blockquote> <p>虽然 HTTP 有很多优秀且方便的特性，但是也同样具有一些不足之处：</p> <ol><li>通信使用明文（不加密）， 内容可能会被窃听</li> <li>不验证通信方的身份， 因此有可能遭遇伪装</li> <li>无法证明报文的完整性， 所以有可能已遭篡改</li></ol> <p>为了有效防止这些弊端，有必要使用 HTTPS。SSL 提供认证和加密处理及摘要功能。仅靠 HTTP 确保完整性是非常困难的，因此 通过和其他协议组合使用来实现这个目标。</p> <h2 id="https协议概述"><a href="#https协议概述" class="header-anchor">#</a> HTTPS协议概述</h2> <p>HTTPS 并非是应用层的一种新协议。只是 HTTP 通信接口部分用 SSL（Secure Socket Layer）和 TLS（Transport Layer Security）协议代 替而已。 TLS 是<strong>传输层加密协议</strong>，他的前身是 SSL 协议。</p> <p><img src="/study-notes/assets/img/40.625f01e1.png" alt="图示"></p> <p>HTTP 和 TLS 的位置如图所示，TLS 建立在传输层和应用层之间，TLS实际上是 TCP 之上建立了一个加密通道，TLS 协议主要有5各部分，它包含应用数据层协议、握手协议、报警协议、加密消息确认协议和心跳协议。</p> <p>常用的 HTTP 协议是 HTTP/1.1，而常用的 TLS 协议有 TLS/1.2、 TLS/1.1、 TLS/1.0和 SSL/3.0这么几个版本。TLS/1.0和 SSL/3.0其实都存在着一定的安全漏洞，TLS/1.2、 TLS/1.1则没有已知的安全漏洞并且有着大量的访问速度和性能的提升，目前 TLS/1.3 已经发布，相比较之前的版本，有本质上的提升。</p> <h2 id="https-功能介绍"><a href="#https-功能介绍" class="header-anchor">#</a> HTTPS 功能介绍</h2> <p>为了解决前面提到的 HTTP 的一些弊端，HTTPS 就做了以下的功能用来强化自身的能力：</p> <ul><li>内容加密
<ul><li>对称内容加密</li> <li>非对称秘钥交换</li></ul></li> <li>身份认证
<ul><li>数字证书</li></ul></li> <li>数据完整性</li></ul> <h2 id="使用成本"><a href="#使用成本" class="header-anchor">#</a> 使用成本</h2> <ul><li>证书费用以及更新维护</li> <li>HTTPS 降低用户访问速度</li> <li>消耗 CPU 资源，需要增加大量机器</li></ul> <h2 id="对性能的影响"><a href="#对性能的影响" class="header-anchor">#</a> 对性能的影响</h2> <h4 id="协议交互所增加的网络-rtt-round-trip-time-往返时延"><a href="#协议交互所增加的网络-rtt-round-trip-time-往返时延" class="header-anchor">#</a> 协议交互所增加的网络 RTT（round trip time 往返时延）</h4> <center><img src="/study-notes/assets/img/41.6dc51166.png" width="80%" alt="" style="margin:2em 0;border-radius:0.3125em;box-shadow:0 2px 4px 0 rgba(34,36,38,.12),0 2px 10px 0 rgba(34,36,38,.08);"> <br> <div style="color:#999;border-bottom:1px solid #d9d9d9;display:inline-block;padding:2px;">
      HTTP 通讯机制
  	</div></center> <p>对比</p> <center><img src="/study-notes/assets/img/42.2e340212.png" width="80%" alt="" style="margin:2em 0;border-radius:0.3125em;box-shadow:0 2px 4px 0 rgba(34,36,38,.12),0 2px 10px 0 rgba(34,36,38,.08);"> <br> <div style="color:#999;border-bottom:1px solid #d9d9d9;display:inline-block;padding:2px;">
      HTTPS 通讯机制
  	</div></center> <p>如上面两个通讯机制的比对，明显 HTTPS 的通讯步骤要远远麻烦与 HTTP 的通讯，这就意味着 HTTPS 要产生更多的 RTT，最多时会产生7个 RTT。</p> <p>步骤1：三次握手建立 TCP 连接，<strong>耗时一个 RTT</strong>(1)</p> <p>步骤2：客户端发送 GET 请求，服务器端返回 302 跳转到 HTTP，此时会<strong>产生一个 RTT</strong>(2) 和 302 的跳转延时（这里会有一个情况，就是用户一般不会输入完整的 https 地址，而是通过简称，如：baidu.com、jd.com，此时浏览器会先访问 http 域名，然后通过 302 跳转至对应的 https 地址）</p> <p>步骤3：通过 302 跳转到 https 服务器之后，由于端口号和服务器的不同，会重新发送新的 http 请求，完成三次握手，建立 TCP 连接</p> <p>步骤4：TLS 完全握手阶段1，此处会<strong>消耗一个 RTT</strong>(3)，此处会完成加密套件的协商和证书的身份确认，服务器和客户端会协商出相同的秘钥交换算法、对称加密算法、内容一致性校验算法、证书签名算法等，浏览器接收到证书后，也会校验证书的有效性。</p> <p>步骤5：浏览器获取证书中的 CA 域名，如果 CA 域名没有命中缓存的话，浏览器需要解析 CA 域名的 DNS（<strong>消耗一个 RTT</strong>）(4)，DNS 解析完成拿到 ip，需要进行三次握手，建立 CA 站点的 TCP连接（<strong>消耗一个 RTT</strong>）(5)，然后浏览器发送 Ocsp（在线证书状态协议） 请求获取响应（<strong>消耗一个 RTT</strong>）(6)。</p> <p>步骤6：TLS 完全握手阶段2，主要进行的是秘钥协商（<strong>消耗一个 RTT 和计算时间</strong>）(7)。</p> <p>步骤7：上面的完全握手结束后，浏览器和服务器会进行应用层的通讯，也就是 HTTP 的数据传输，跟常规的 HTTP 方式几乎是一致的。</p> <p>经过这么多的步骤，最多会产生7个 RTT，但并不是所有的请求都会产生7个 RTT 才会完成 HTTPS 的首次请求交互，比如 CA 命中了缓存，则不会发生 CA 解析。但从上述结果来看， HTTPS 的网络消耗一定是会略大约 HTTP 的。</p></div> <footer class="page-edit"><!----> <div class="last-updated"><span class="prefix">最后更新时间:</span> <span class="time">8/25/2021, 4:44:53 PM</span></div></footer> <div class="page-nav"><p class="inner"><span class="prev">
      ←
      <a href="/study-notes/HTTP/HTTP的特性和使用.html" class="prev">
        HTTP的特性和使用
      </a></span> <span class="next"><a href="/study-notes/HTTP/基于HTTP追加协议.html">
        基于HTTP追加协议
      </a>
      →
    </span></p></div> </main></div><div class="global-ui"></div></div>
    <script src="/study-notes/assets/js/app.039e21f8.js" defer></script><script src="/study-notes/assets/js/2.c66ffe4c.js" defer></script><script src="/study-notes/assets/js/12.6d5c0016.js" defer></script>
  </body>
</html>
