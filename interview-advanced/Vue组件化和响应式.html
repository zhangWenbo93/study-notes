<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Vue组件化和响应式 | Notes</title>
    <meta name="generator" content="VuePress 1.7.1">
    
    <meta name="description" content="自我学习">
    
    <link rel="preload" href="/study-notes/assets/css/0.styles.f313a13a.css" as="style"><link rel="preload" href="/study-notes/assets/js/app.039e21f8.js" as="script"><link rel="preload" href="/study-notes/assets/js/2.c66ffe4c.js" as="script"><link rel="preload" href="/study-notes/assets/js/20.3d35b0e0.js" as="script"><link rel="prefetch" href="/study-notes/assets/js/10.1f4a0ba6.js"><link rel="prefetch" href="/study-notes/assets/js/11.3f135838.js"><link rel="prefetch" href="/study-notes/assets/js/12.6d5c0016.js"><link rel="prefetch" href="/study-notes/assets/js/13.385e80e5.js"><link rel="prefetch" href="/study-notes/assets/js/14.0abbf9c6.js"><link rel="prefetch" href="/study-notes/assets/js/15.f1a675c1.js"><link rel="prefetch" href="/study-notes/assets/js/16.cff045ba.js"><link rel="prefetch" href="/study-notes/assets/js/17.1b9fa201.js"><link rel="prefetch" href="/study-notes/assets/js/18.15b4e5fe.js"><link rel="prefetch" href="/study-notes/assets/js/19.96819d01.js"><link rel="prefetch" href="/study-notes/assets/js/21.b1b57cb8.js"><link rel="prefetch" href="/study-notes/assets/js/22.33771dfd.js"><link rel="prefetch" href="/study-notes/assets/js/23.a732b160.js"><link rel="prefetch" href="/study-notes/assets/js/24.24b15227.js"><link rel="prefetch" href="/study-notes/assets/js/25.69c4ed30.js"><link rel="prefetch" href="/study-notes/assets/js/26.78ff0822.js"><link rel="prefetch" href="/study-notes/assets/js/27.fe95212f.js"><link rel="prefetch" href="/study-notes/assets/js/28.7ad1509a.js"><link rel="prefetch" href="/study-notes/assets/js/29.61218e4f.js"><link rel="prefetch" href="/study-notes/assets/js/3.63146466.js"><link rel="prefetch" href="/study-notes/assets/js/30.f23314bb.js"><link rel="prefetch" href="/study-notes/assets/js/31.cdae011c.js"><link rel="prefetch" href="/study-notes/assets/js/32.60127ca6.js"><link rel="prefetch" href="/study-notes/assets/js/33.ff9cf28d.js"><link rel="prefetch" href="/study-notes/assets/js/34.7746944f.js"><link rel="prefetch" href="/study-notes/assets/js/35.0216b661.js"><link rel="prefetch" href="/study-notes/assets/js/36.fcf7055f.js"><link rel="prefetch" href="/study-notes/assets/js/37.6e2d7c68.js"><link rel="prefetch" href="/study-notes/assets/js/38.a9661128.js"><link rel="prefetch" href="/study-notes/assets/js/39.f25b8af3.js"><link rel="prefetch" href="/study-notes/assets/js/4.1b408ca5.js"><link rel="prefetch" href="/study-notes/assets/js/40.b2812eac.js"><link rel="prefetch" href="/study-notes/assets/js/41.e63c192c.js"><link rel="prefetch" href="/study-notes/assets/js/42.91310054.js"><link rel="prefetch" href="/study-notes/assets/js/43.195adb7b.js"><link rel="prefetch" href="/study-notes/assets/js/44.b82e0971.js"><link rel="prefetch" href="/study-notes/assets/js/45.54e35d71.js"><link rel="prefetch" href="/study-notes/assets/js/46.4b06e4d8.js"><link rel="prefetch" href="/study-notes/assets/js/47.c58d11ab.js"><link rel="prefetch" href="/study-notes/assets/js/48.69319e05.js"><link rel="prefetch" href="/study-notes/assets/js/49.81df32c4.js"><link rel="prefetch" href="/study-notes/assets/js/5.45c26daa.js"><link rel="prefetch" href="/study-notes/assets/js/50.b86cd1f2.js"><link rel="prefetch" href="/study-notes/assets/js/51.48962766.js"><link rel="prefetch" href="/study-notes/assets/js/52.d5814608.js"><link rel="prefetch" href="/study-notes/assets/js/53.12683cf2.js"><link rel="prefetch" href="/study-notes/assets/js/54.7f8f2a18.js"><link rel="prefetch" href="/study-notes/assets/js/55.397b6083.js"><link rel="prefetch" href="/study-notes/assets/js/56.ab7945ea.js"><link rel="prefetch" href="/study-notes/assets/js/57.d03d45cb.js"><link rel="prefetch" href="/study-notes/assets/js/58.bae8dfce.js"><link rel="prefetch" href="/study-notes/assets/js/59.c7d972b0.js"><link rel="prefetch" href="/study-notes/assets/js/6.ceefd9a6.js"><link rel="prefetch" href="/study-notes/assets/js/60.50c38210.js"><link rel="prefetch" href="/study-notes/assets/js/61.2d11d07c.js"><link rel="prefetch" href="/study-notes/assets/js/62.6b2af576.js"><link rel="prefetch" href="/study-notes/assets/js/63.826c65fe.js"><link rel="prefetch" href="/study-notes/assets/js/64.9960e579.js"><link rel="prefetch" href="/study-notes/assets/js/65.ff4ea3f1.js"><link rel="prefetch" href="/study-notes/assets/js/66.f6631330.js"><link rel="prefetch" href="/study-notes/assets/js/67.d010895e.js"><link rel="prefetch" href="/study-notes/assets/js/68.55195346.js"><link rel="prefetch" href="/study-notes/assets/js/69.05dc4f2e.js"><link rel="prefetch" href="/study-notes/assets/js/7.22afd591.js"><link rel="prefetch" href="/study-notes/assets/js/70.9b1fb209.js"><link rel="prefetch" href="/study-notes/assets/js/71.eff503c4.js"><link rel="prefetch" href="/study-notes/assets/js/72.1c282bd5.js"><link rel="prefetch" href="/study-notes/assets/js/73.6258956d.js"><link rel="prefetch" href="/study-notes/assets/js/74.8debcd50.js"><link rel="prefetch" href="/study-notes/assets/js/75.4cef4522.js"><link rel="prefetch" href="/study-notes/assets/js/76.b4268a30.js"><link rel="prefetch" href="/study-notes/assets/js/77.0ec777b3.js"><link rel="prefetch" href="/study-notes/assets/js/8.c8a1b87b.js"><link rel="prefetch" href="/study-notes/assets/js/9.f05e9459.js">
    <link rel="stylesheet" href="/study-notes/assets/css/0.styles.f313a13a.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/study-notes/" class="home-link router-link-active"><!----> <span class="site-name">Notes</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="笔记" class="dropdown-title"><span class="title">笔记</span> <span class="arrow down"></span></button> <button type="button" aria-label="笔记" class="mobile-dropdown-title"><span class="title">笔记</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/study-notes/koa2/restful.html" class="nav-link">
  koa2
</a></li><li class="dropdown-item"><!----> <a href="/study-notes/design-patterns/面向对象_01.html" class="nav-link">
  设计模式
</a></li><li class="dropdown-item"><!----> <a href="/study-notes/interview-advanced/mind-mapping.html" class="nav-link">
  能力进阶
</a></li><li class="dropdown-item"><!----> <a href="/study-notes/cms-vue/advance.html" class="nav-link">
  vue koa 实现后台管理
</a></li><li class="dropdown-item"><!----> <a href="/study-notes/HTTP/了解HTTP协议.html" class="nav-link">
  HTTP协议
</a></li><li class="dropdown-item"><!----> <a href="/study-notes/node/Node.js在前后端的区别.html" class="nav-link">
  node应用开发
</a></li></ul></div></div> <!----></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="笔记" class="dropdown-title"><span class="title">笔记</span> <span class="arrow down"></span></button> <button type="button" aria-label="笔记" class="mobile-dropdown-title"><span class="title">笔记</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/study-notes/koa2/restful.html" class="nav-link">
  koa2
</a></li><li class="dropdown-item"><!----> <a href="/study-notes/design-patterns/面向对象_01.html" class="nav-link">
  设计模式
</a></li><li class="dropdown-item"><!----> <a href="/study-notes/interview-advanced/mind-mapping.html" class="nav-link">
  能力进阶
</a></li><li class="dropdown-item"><!----> <a href="/study-notes/cms-vue/advance.html" class="nav-link">
  vue koa 实现后台管理
</a></li><li class="dropdown-item"><!----> <a href="/study-notes/HTTP/了解HTTP协议.html" class="nav-link">
  HTTP协议
</a></li><li class="dropdown-item"><!----> <a href="/study-notes/node/Node.js在前后端的区别.html" class="nav-link">
  node应用开发
</a></li></ul></div></div> <!----></nav>  <ul class="sidebar-links"><li><section class="sidebar-group depth-0"><p class="sidebar-heading open"><span>能力进阶</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/study-notes/interview-advanced/Vue组件化和响应式.html" class="active sidebar-link">Vue组件化和响应式</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/study-notes/interview-advanced/Vue组件化和响应式.html#组件化" class="sidebar-link">组件化</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/study-notes/interview-advanced/Vue组件化和响应式.html#mvvm" class="sidebar-link">MVVM</a></li></ul></li><li class="sidebar-sub-header"><a href="/study-notes/interview-advanced/Vue组件化和响应式.html#响应式" class="sidebar-link">响应式</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/study-notes/interview-advanced/Vue组件化和响应式.html#实现一个简单的视图更新" class="sidebar-link">实现一个简单的视图更新</a></li></ul></li></ul></li><li><a href="/study-notes/interview-advanced/虚拟DOM和diff算法.html" class="sidebar-link">Vue虚拟DOM和diff算法</a></li><li><a href="/study-notes/interview-advanced/模板编译.html" class="sidebar-link">Vue模板编译</a></li><li><a href="/study-notes/interview-advanced/渲染流程.html" class="sidebar-link">Vue渲染流程</a></li><li><a href="/study-notes/interview-advanced/前端路由原理.html" class="sidebar-link">前端路由原理</a></li><li><a href="/study-notes/interview-advanced/webpack.html" class="sidebar-link">webpack</a></li></ul></section></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h1 id="vue组件化和响应式"><a href="#vue组件化和响应式" class="header-anchor">#</a> Vue组件化和响应式</h1> <h2 id="组件化"><a href="#组件化" class="header-anchor">#</a> 组件化</h2> <p>在 php，node 开发的时候其实就已经有所谓的组件化，但当时都是静态渲染，依赖于操作 DOM，后来在 Vue、React 中都做了组件化的创新，使用<strong>数据驱动视图</strong>，其中 Vue 中是通过 MVVM，React 中则是通过 setData。</p> <h3 id="mvvm"><a href="#mvvm" class="header-anchor">#</a> MVVM</h3> <p>如下图所示：
<img src="data:image/png;base64,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" alt="MVVM"></p> <ul><li>Model：在 Vue 中其实就是组件中的 data、vuex等的数据源。</li> <li>View：是面向用户操作展示的操作界面，在 Vue 中其实就是 <code>&lt;templete&gt;</code> 包裹的 DOM 层。</li> <li>ViewMode：这个比较抽象，可以理解成是一个集合层，其中包含对 DOM 绑定的一系列事件监听和组件中 methods 等所包含的 Vue 指令等。</li></ul> <h2 id="响应式"><a href="#响应式" class="header-anchor">#</a> 响应式</h2> <p>核心API：</p> <ul><li>Object.defineProperty： Vue2.x中响应式核心，但是有一些缺点</li> <li>Proxy：Vue3.x中响应式核心，兼容性不好，ie11，部分安卓老系统不支持，并且无法polyfill</li></ul> <p>Object.defineProperty(obj, prop, descriptor)有三个参数分别表示为：</p> <ul><li>obj: 目标对象</li> <li>prop: 需要操作的目标对象的属性名</li> <li>descriptor: 描述符</li></ul> <h3 id="实现一个简单的视图更新"><a href="#实现一个简单的视图更新" class="header-anchor">#</a> 实现一个简单的视图更新</h3> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">function</span> <span class="token function">updateView</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'视图更新'</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>

<span class="token keyword">function</span> <span class="token function">defineReactive</span><span class="token punctuation">(</span><span class="token parameter">obj<span class="token punctuation">,</span>key<span class="token punctuation">,</span>value</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    Object<span class="token punctuation">.</span><span class="token function">defineProperty</span><span class="token punctuation">(</span>obj<span class="token punctuation">,</span>key<span class="token punctuation">,</span> <span class="token punctuation">{</span>
        enumerable<span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>    <span class="token comment">/* 属性可枚举 */</span>
        configurable<span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>   <span class="token comment">/* 属性可被修改或删除 */</span>
        <span class="token function">get</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token keyword">return</span> value
        <span class="token punctuation">}</span><span class="token punctuation">,</span>
        <span class="token function">set</span><span class="token punctuation">(</span>newValue<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token keyword">if</span><span class="token punctuation">(</span>newValue <span class="token operator">!==</span> value<span class="token punctuation">)</span> <span class="token punctuation">{</span>
                value <span class="token operator">=</span> newValue
                <span class="token function">updateView</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>


<span class="token keyword">function</span> <span class="token function">observer</span><span class="token punctuation">(</span><span class="token parameter">target</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token keyword">typeof</span> target <span class="token operator">!==</span> <span class="token string">'object'</span> <span class="token operator">||</span> <span class="token operator">!</span>target<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> target
    <span class="token punctuation">}</span>

    <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">const</span> key <span class="token keyword">in</span> target<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token function">defineReactive</span><span class="token punctuation">(</span>target<span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token keyword">const</span> data <span class="token operator">=</span> <span class="token punctuation">{</span>
    age<span class="token operator">:</span> <span class="token number">24</span><span class="token punctuation">,</span>
    name<span class="token operator">:</span> <span class="token string">'lili'</span>
<span class="token punctuation">}</span>
<span class="token comment">// 监听数据</span>
<span class="token function">observer</span><span class="token punctuation">(</span>data<span class="token punctuation">)</span>
</code></pre></div><p>通过上述代码，我们实现了一个简单的响应式更新，当我们对 data 中的 age，name重新赋值时，浏览器会打印两次“视图更新”，但当 data 变成如下数据时，</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">const</span> data <span class="token operator">=</span> <span class="token punctuation">{</span>
    age<span class="token operator">:</span> <span class="token number">24</span><span class="token punctuation">,</span>
    name<span class="token operator">:</span> <span class="token string">'lili'</span><span class="token punctuation">,</span>
    info<span class="token operator">:</span> <span class="token punctuation">{</span>
        address<span class="token operator">:</span> <span class="token string">'北京'</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><p>更新 data.info.address 时，则不会打印“视图更新”，此时需对代码做修改，以<strong>满足深度监听的条件</strong>。</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token operator">...</span>

<span class="token keyword">function</span> <span class="token function">defineReactive</span><span class="token punctuation">(</span><span class="token parameter">obj<span class="token punctuation">,</span>key<span class="token punctuation">,</span>value</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// 深度监听</span>
    <span class="token function">observer</span><span class="token punctuation">(</span>value<span class="token punctuation">)</span>

    Object<span class="token punctuation">.</span><span class="token function">defineProperty</span><span class="token punctuation">(</span>obj<span class="token punctuation">,</span>key<span class="token punctuation">,</span> <span class="token punctuation">{</span>
        enumerable<span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>    <span class="token comment">/* 属性可枚举 */</span>
        configurable<span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>   <span class="token comment">/* 属性可被修改或删除 */</span>
        <span class="token function">get</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token keyword">return</span> value
        <span class="token punctuation">}</span><span class="token punctuation">,</span>
        <span class="token function">set</span><span class="token punctuation">(</span>newValue<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token keyword">if</span><span class="token punctuation">(</span>newValue <span class="token operator">!==</span> value<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token comment">// 深度监听</span>
                <span class="token function">observer</span><span class="token punctuation">(</span>newValue<span class="token punctuation">)</span>
                <span class="token comment">// value 一直处于闭包中，此时设置完成后，在通过 get 获取的值也是新值</span>
                value <span class="token operator">=</span> newValue
                <span class="token function">updateView</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>

<span class="token operator">...</span>

</code></pre></div><p>通过递归对 data 中的嵌套对象进行更深一步的监听，这样更新 data.info.address 时，原视图就会被更新。</p> <p>下面我们对 data 作如下操作，</p> <div class="language-js extra-class"><pre class="language-js"><code>data<span class="token punctuation">.</span>phone <span class="token operator">=</span> <span class="token string">'123456'</span>
<span class="token keyword">delete</span> data<span class="token punctuation">.</span>name
</code></pre></div><p>我们发现并没有打印“视图更新”，原因是当新增或者删除属性时，并不会触发 Object.defineProperty 方法，因此无法监听到属性的新增和删除，也就无法操作对应的视图更新，因此对于新增通过 Vue.set，对于删除通过 Vue.delete。</p> <p>当 data 变成如下数据时，操作 data.nums.push(4)，数据发生更改，希望得到“视图更新”，但是并没有，因为 Object.defineProperty 不具备监听数组的能力。</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">const</span> data <span class="token operator">=</span> <span class="token punctuation">{</span>
    age<span class="token operator">:</span> <span class="token number">24</span><span class="token punctuation">,</span>
    name<span class="token operator">:</span> <span class="token string">'lili'</span><span class="token punctuation">,</span>
    info<span class="token operator">:</span> <span class="token punctuation">{</span>
        address<span class="token operator">:</span> <span class="token string">'北京'</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    nums<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">]</span>
<span class="token punctuation">}</span>
</code></pre></div><p>改造如下：</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token operator">...</span>

<span class="token comment">// 重新定义数组原型</span>
<span class="token keyword">const</span> oldArrayProperty <span class="token operator">=</span> <span class="token class-name">Array</span><span class="token punctuation">.</span>prototype
<span class="token keyword">const</span> arrProto  <span class="token operator">=</span> Object<span class="token punctuation">.</span><span class="token function">create</span><span class="token punctuation">(</span>oldArrayProperty<span class="token punctuation">)</span>   <span class="token comment">//创建新对象，原型指向 oldArrayProperty</span>
<span class="token punctuation">[</span><span class="token string">'push'</span><span class="token punctuation">,</span><span class="token string">'shift'</span><span class="token punctuation">,</span><span class="token string">'unshift'</span><span class="token punctuation">,</span><span class="token string">'pop'</span><span class="token punctuation">,</span><span class="token string">'splice'</span><span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">forEach</span><span class="token punctuation">(</span><span class="token parameter">methods</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    arrProto<span class="token punctuation">[</span>methods<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token function">updateView</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
        oldArrayProperty<span class="token punctuation">[</span>methods<span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">call</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">,</span><span class="token operator">...</span>arguments<span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>

<span class="token keyword">function</span> <span class="token function">observer</span><span class="token punctuation">(</span><span class="token parameter">target</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token keyword">typeof</span> target <span class="token operator">!==</span> <span class="token string">'object'</span> <span class="token operator">||</span> <span class="token operator">!</span>target<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> target
    <span class="token punctuation">}</span>

    <span class="token keyword">if</span><span class="token punctuation">(</span>Array<span class="token punctuation">.</span><span class="token function">isArray</span><span class="token punctuation">(</span>target<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        target<span class="token punctuation">.</span>_proto_ <span class="token operator">=</span> arrProto
    <span class="token punctuation">}</span>

    <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">const</span> key <span class="token keyword">in</span> target<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token function">defineReactive</span><span class="token punctuation">(</span>target<span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token operator">...</span>

</code></pre></div><p>通过上述制造，当我们使用 data.nums.push(4) 更新data时，则会打印“视图更新”。</p> <p>由此可见，Object.defineProperty 存在一定的缺陷，比如：</p> <ol><li>深度监听时，需要递归处理到底，一次性计算量大</li> <li>无法监听新增、删除属性（Vue.set  Vue.delete）</li> <li>无法监听数组，需要做特殊处理</li></ol></div> <footer class="page-edit"><!----> <div class="last-updated"><span class="prefix">最后更新时间:</span> <span class="time">9/5/2022, 12:36:43 PM</span></div></footer> <div class="page-nav"><p class="inner"><!----> <span class="next"><a href="/study-notes/interview-advanced/虚拟DOM和diff算法.html">
        Vue虚拟DOM和diff算法
      </a>
      →
    </span></p></div> </main></div><div class="global-ui"></div></div>
    <script src="/study-notes/assets/js/app.039e21f8.js" defer></script><script src="/study-notes/assets/js/2.c66ffe4c.js" defer></script><script src="/study-notes/assets/js/20.3d35b0e0.js" defer></script>
  </body>
</html>
